from shufflify import PluginBase
import random
from math import ceil

def ogr(length):
    ogrs = {1:[1], 2:[1,2], 3:[1,3,2], 4:[1,3,5,2], 5:[1,3,6,2,5], 6:[1,3,6,8,5,2], 7:[1,3,5,6,7,10,2], 8:[1,4,7,13,2,8,6,3], 9:[1,5,4,13,3,8,7,12,2], 10:[1,3,9,15,5,14,7,10,6,2], 11:[2,4,18,5,11,3,12,13,7,1,9], 12:[2,3,20,12,6,16,11,15,4,9,1,7], 13:[4,2,14,15,17,7,18,1,8,3,10,23,5], 14:[4,16,10,27,2,3,14,24,11,12,13,8,1,6], 15:[1,3,7,15,6,24,12,8,39,2,17,16,13,5,9], 16:[5,2,10,35,4,11,13,1,19,22,16,21,6,3,23,8], 17:[2,8,12,31,3,26,1,6,9,32,18,5,14,21,4,13,11], 18:[1,5,19,7,40,28,8,12,10,23,16,18,3,14,27,2,9,4], 19:[1,7,3,57,9,17,22,5,35,2,21,15,14,4,16,12,13,6,24], 20:[2,22,32,21,5,1,12,34,15,35,7,9,60,10,20,8,3,14,19,4], 21:[1,8,5,29,27,36,16,2,4,31,20,25,19,30,10,7,21,39,11,12,3], 22:[3,4,10,44,5,25,8,15,45,12,28,1,26,9,11,31,39,13,19,2,16,6], 23:[9,24,4,1,59,25,7,11,2,10,39,14,3,44,26,8,40,6,21,15,16,19,22], 24:[12,17,10,33,19,55,11,3,1,5,25,16,7,44,32,26,38,18,22,2,35,28,8,13], 25:[1,32,50,21,6,14,39,22,15,3,46,2,7,56,4,25,13,30,44,10,16,8,11,12,5], 26:[3,12,26,25,29,2,9,36,10,68,1,4,17,53,35,8,16,28,6,14,13,71,18,19,23,7], 27:[3,12,26,25,29,2,9,36,10,68,1,4,17,53,35,8,16,28,6,14,13,71,18,19,23,7,32], 28:[3,25,5,8,54,61,2,35,14,26,19,15,71,1,16,39,9,18,52,6,23,21,47,10,12,20,4,7], 29:[9,26,22,71,21,2,29,25,13,63,11,44,28,6,8,16,75,4,1,40,19,47,15,3,33,10,7,20,12], 30:[9,3,42,25,64,2,16,31,13,21,85,38,14,19,4,53,20,7,8,28,58,1,10,30,68,6,26,24,5,17], 31:[7,8,11,2,29,55,6,18,40,1,4,30,3,44,51,9,23,48,14,53,20,36,16,54,46,43,25,49,17,10,12], 32:[12,80,4,55,3,20,1,51,60,14,35,8,11,99,6,40,2,29,10,26,30,7,27,88,5,13,15,17,44,9,16,22], 33:[4,15,16,42,22,26,23,14,74,13,33,8,76,21,17,27,28,11,36,34,45,94,6,18,43,25,78,20,9,1,2,50,7], 34:[2,22,12,74,9,8,33,93,30,27,4,21,14,45,1,70,19,49,29,43,26,6,73,15,13,64,23,44,55,7,3,37,11,5], 35:[5,11,37,3,7,55,44,23,64,13,15,73,6,26,43,29,49,19,70,1,45,14,21,4,27,30,93,33,8,9,74,12,22,2,18], 36:[8,1,4,57,27,21,19,85,15,23,7,34,52,29,17,134,31,6,10,12,32,11,25,58,18,2,33,39,3,66,51,56,26,24,49,14], 37:[5,51,40,112,4,15,16,42,22,26,23,14,74,13,33,8,76,21,17,27,28,11,36,34,45,94,6,18,43,25,78,20,9,1,2,50,7], 38:[7,9,88,20,25,24,10,28,67,14,19,23,99,17,40,63,77,29,6,2,46,18,12,68,47,3,41,11,82,71,39,21,1,4,27,43,15,36], 39:[9,6,64,18,34,16,59,39,57,28,4,74,13,58,49,37,8,17,10,46,44,95,47,22,11,3,40,23,38,92,20,1,30,103,2,5,19,29,12], 40:[4,22,12,27,81,23,5,8,24,55,47,25,78,16,19,71,6,9,67,7,33,51,46,3,98,54,2,29,14,30,20,68,57,66,48,10,11,41,1,17], 41:[2,87,12,35,27,4,79,37,19,5,43,33,73,44,14,22,23,82,50,1,63,7,25,28,65,77,9,11,10,8,84,6,40,112,17,52,3,13,26,15,34], 42:[3,31,2,7,15,39,28,77,13,73,14,60,38,19,18,48,103,1,4,45,20,51,8,17,133,32,10,11,81,46,16,52,12,29,6,72,23,83,30,26,84,27], 43:[58,14,61,57,3,21,105,25,7,2,29,56,115,1,36,18,28,19,23,20,30,67,10,16,53,104,8,41,100,6,74,4,11,33,66,68,45,51,13,22,5,12,59], 44:[3,63,13,24,34,38,32,23,130,33,11,4,73,117,45,8,6,43,67,22,122,35,27,25,39,51,18,50,10,20,1,74,61,46,40,112,2,17,9,56,29,7,5,42], 45:[1,64,15,57,28,6,5,24,47,108,60,90,19,22,14,12,77,4,45,69,9,50,97,42,33,20,17,51,66,7,25,62,116,3,27,16,40,18,84,38,61,31,13,8,2], 46:[6,32,5,44,114,56,34,8,15,95,12,4,124,25,77,17,54,14,36,67,22,52,41,64,24,92,31,20,7,26,2,11,120,63,45,61,21,9,10,59,1,72,3,62,18,29], 47:[5,2,27,4,73,12,10,145,20,58,42,30,26,113,1,18,62,112,9,153,11,35,6,8,45,43,47,54,28,37,32,39,44,48,15,40,21,3,157,25,50,16,51,17,57,13,23], 48:[2,68,8,55,40,22,83,79,12,85,7,35,11,14,4,30,84,107,23,27,31,151,10,9,32,24,72,16,36,57,49,73,37,1,5,39,90,77,98,15,13,61,26,21,33,66,3,17], 49:[31,17,19,54,139,5,20,99,38,1,70,8,16,34,3,4,11,134,62,44,60,14,12,153,56,10,30,63,9,13,69,6,23,84,43,21,28,77,46,55,100,42,45,2,33,81,27,32,51], 50:[1,7,18,13,110,74,24,108,29,35,20,46,21,2,40,37,59,6,111,139,36,14,68,17,5,70,58,49,27,45,33,15,143,9,3,16,162,62,53,30,11,32,54,71,60,52,4,47,10,34], 51:[34,10,47,4,52,60,71,54,32,11,30,53,62,162,16,3,9,143,15,33,45,27,49,58,70,5,17,68,14,36,139,111,6,59,37,40,2,21,46,20,35,29,108,24,74,110,13,18,7,1,80], 52:[1,8,21,77,104,37,25,24,33,42,14,66,76,44,15,13,55,53,70,31,131,20,2,5,36,11,40,18,60,79,38,109,65,46,4,146,17,71,81,16,3,45,85,10,134,39,34,91,12,23,61,6,], 53:[1,8,21,77,104,37,25,24,33,42,14,66,76,44,15,13,55,53,70,31,131,20,2,5,36,11,40,18,60,79,38,109,65,46,4,146,17,71,81,16,3,45,85,10,134,39,34,91,12,23,61,6,26,], 54:[2,3,13,12,37,100,32,93,34,7,50,88,73,107,11,33,54,22,68,117,95,58,64,38,8,155,75,9,1,51,53,19,24,35,4,17,94,60,48,31,97,45,36,164,6,71,42,27,74,15,14,26,66,20], 55:[12,14,74,115,5,10,1,61,25,135,64,85,6,23,8,39,36,175,103,4,44,104,19,9,156,42,50,3,68,22,119,27,13,20,34,99,17,46,38,41,2,30,66,172,55,118,18,51,57,21,35,24,58,7,45], 56:[1,6,39,30,41,9,43,84,64,25,3,23,124,35,224,103,2,8,19,38,20,24,139,40,59,98,60,47,15,73,61,17,5,31,153,48,33,21,42,37,12,118,13,55,86,11,95,34,32,72,56,14,4,90,121,16], 57:[3,55,11,56,21,27,32,1,97,102,49,2,217,50,45,23,41,53,74,36,4,184,9,92,31,8,85,57,29,43,166,20,6,28,42,37,47,15,46,152,30,14,75,16,139,10,7,5,13,65,38,73,112,52,19,63,24], 58:[4,10,119,29,56,182,15,20,5,33,44,59,95,13,121,74,51,50,76,17,49,32,46,42,19,11,41,34,65,165,22,9,80,3,149,57,39,70,94,62,1,6,21,26,84,97,145,8,37,23,64,36,12,43,24,104,2,16], 59:[13,55,145,79,22,20,1,26,4,143,7,132,126,18,53,34,10,89,36,67,88,8,86,23,2,140,90,41,54,29,46,17,65,9,84,14,127,106,6,52,12,50,16,118,33,28,11,38,100,60,102,57,19,5,32,3,45,108,15], 60:[4,24,16,50,206,71,38,104,31,67,21,57,56,18,12,29,32,148,3,96,22,20,117,9,14,144,33,184,26,10,15,2,70,5,79,95,37,43,110,39,46,8,68,35,162,60,52,13,101,19,45,63,100,6,1,48,34,47,58,11], 61:[12,141,73,26,41,45,56,92,89,13,122,34,105,27,76,1,87,28,133,138,9,48,4,93,20,196,6,64,54,31,49,29,94,82,2,66,32,30,95,106,14,23,46,75,15,24,72,35,44,108,19,40,51,119,7,3,8,25,17,5,16], 62:[10,8,148,27,21,14,80,38,26,198,57,20,16,97,134,65,54,1,41,28,160,3,50,23,52,11,174,211,5,4,74,24,7,40,19,13,99,95,67,60,116,25,43,87,108,2,37,12,33,56,81,30,58,34,117,6,85,15,29,17,104,22], 63:[8,36,166,21,16,71,1,191,14,102,25,42,13,19,142,2,9,120,158,78,17,28,119,24,46,15,50,3,81,26,5,33,284,4,18,83,54,96,7,51,40,86,60,79,39,82,12,23,34,56,211,27,48,29,20,43,30,59,41,6,162,52,10,], 64:[8,36,166,21,16,71,1,191,14,102,25,42,13,19,142,2,9,120,158,78,17,28,119,24,46,15,50,3,81,26,5,33,284,4,18,83,54,96,7,51,40,86,60,79,39,82,12,23,34,56,211,27,48,29,20,43,30,59,41,6,162,52,10,66,], 65:[17,8,19,91,45,43,53,69,46,35,14,65,104,66,34,23,162,5,6,4,16,47,30,24,221,90,92,33,22,29,32,28,42,56,68,120,9,139,13,86,134,38,3,181,21,107,12,52,7,130,142,1,105,40,212,2,48,37,72,82,74,39,36,58,18], 66:[17,8,19,91,45,43,53,69,46,35,14,65,104,66,34,23,162,5,6,4,16,47,30,24,221,90,92,33,22,29,32,28,42,56,68,120,9,139,13,86,134,38,3,181,21,107,12,52,7,130,142,1,105,40,212,2,48,37,72,82,74,39,36,58,18,62], 67:[14,120,73,13,197,76,34,11,42,7,75,161,93,9,37,175,54,24,38,88,12,3,74,69,112,6,183,51,174,35,17,80,48,2,29,26,1,95,152,21,71,44,81,32,66,19,148,83,28,33,107,16,4,39,25,65,192,22,8,10,91,63,36,5,67,47,23], 68:[7,24,95,68,19,2,28,51,289,23,101,40,3,94,103,26,153,4,65,140,9,139,110,35,13,99,34,29,10,5,47,36,25,192,37,118,114,203,1,76,16,42,64,32,169,27,11,71,33,17,57,86,84,6,12,54,180,22,45,8,120,46,85,20,60,56,14,41], 69:[18,6,23,52,4,40,33,76,117,62,58,30,72,34,93,39,22,19,12,59,174,9,60,38,83,1,20,74,115,11,97,78,55,196,43,118,51,35,14,148,87,54,3,13,155,46,45,37,28,36,123,8,105,231,26,63,48,66,50,134,124,139,67,68,130,10,5,2,25], 70:[13,1,17,101,80,6,98,60,150,102,27,12,3,26,9,76,66,44,30,32,194,220,7,47,37,193,4,90,19,21,48,51,36,67,5,160,81,34,73,55,83,65,28,97,71,137,52,11,64,25,33,24,92,121,2,20,23,124,183,79,16,96,49,10,46,117,136,70,8,53], 71:[9,47,38,26,10,29,97,73,257,14,21,87,98,6,141,25,2,16,12,101,66,79,139,24,8,52,203,58,1,4,110,138,95,106,80,68,41,3,42,33,50,7,92,137,70,82,23,46,54,34,181,13,49,155,61,15,102,81,96,11,20,17,116,77,142,19,53,71,22,67,51], 72:[9,47,38,26,10,29,97,73,257,14,21,87,98,6,141,25,2,16,12,101,66,79,139,24,8,52,203,58,1,4,110,138,95,106,80,68,41,3,42,33,50,7,92,137,70,82,23,46,54,34,181,13,49,155,61,15,102,81,96,11,20,17,116,77,142,19,53,71,22,67,51,40], 73:[40,51,67,22,71,53,19,142,77,116,17,20,11,96,81,102,15,61,155,49,13,181,34,54,46,23,82,70,137,92,7,50,33,42,3,41,68,80,106,95,138,110,4,1,58,203,52,8,24,139,79,66,101,12,16,2,25,141,6,98,87,21,14,257,73,97,29,10,26,38,47,9,240], 74:[7,20,25,108,114,1,179,60,56,42,15,176,16,94,31,76,129,36,50,49,29,17,54,184,24,37,40,19,93,303,102,32,2,122,105,63,10,200,53,35,9,14,51,66,55,26,4,18,373,83,8,13,142,41,28,118,39,33,47,123,148,106,138,6,62,64,11,139,38,5,84,3,67,12], 75:[21,47,6,8,22,161,117,27,184,62,2,124,70,193,81,9,79,66,76,29,38,33,13,218,121,11,1,86,41,99,7,160,101,48,3,56,63,55,159,103,60,35,34,123,49,45,52,78,32,40,253,17,187,102,80,31,26,18,10,158,37,5,148,25,109,220,16,4,73,19,24,15,50,91,23], 76:[21,47,6,8,22,161,117,27,184,62,2,124,70,193,81,9,79,66,76,29,38,33,13,218,121,11,1,86,41,99,7,160,101,48,3,56,63,55,159,103,60,35,34,123,49,45,52,78,32,40,253,17,187,102,80,31,26,18,10,158,37,5,148,25,109,220,16,4,73,19,24,15,50,91,23,115], 77:[4,59,54,23,79,8,29,7,71,99,254,11,75,68,121,90,18,149,159,144,30,2,49,43,88,197,21,6,13,82,148,74,168,31,147,5,93,39,26,70,185,46,10,50,184,17,35,3,100,66,84,97,91,20,105,141,12,22,157,16,25,28,14,47,15,57,1,209,85,80,48,64,126,45,127,24,9], 78:[4,59,54,23,79,8,29,7,71,99,254,11,75,68,121,90,18,149,159,144,30,2,49,43,88,197,21,6,13,82,148,74,168,31,147,5,93,39,26,70,185,46,10,50,184,17,35,3,100,66,84,97,91,20,105,141,12,22,157,16,25,28,14,47,15,57,1,209,85,80,48,64,126,45,127,24,9,109], 79:[9,14,25,83,26,33,22,123,90,24,136,36,74,75,44,43,78,40,92,47,49,3,27,97,19,13,184,35,72,28,141,57,4,54,15,71,42,269,6,194,88,80,199,16,34,12,5,120,38,64,183,31,53,7,147,70,103,117,63,41,192,68,21,77,8,430,29,65,1,10,101,133,18,2,150,155,56,37,45,], 80:[19,8,3,65,16,46,108,168,59,69,32,139,135,40,110,66,7,24,25,169,83,36,85,181,28,42,144,93,63,50,39,13,35,12,106,14,23,41,256,6,90,134,54,75,4,82,18,221,126,61,136,146,45,29,148,109,33,5,15,2,123,103,151,44,80,34,71,88,43,217,94,107,9,1,57,115,26,51,21,91], 81:[24,28,14,40,36,50,43,161,32,188,51,87,49,121,45,85,59,89,58,16,53,10,70,270,61,38,56,25,39,114,31,29,5,12,246,71,312,1,22,101,8,67,68,113,72,62,26,4,11,171,19,78,162,107,122,35,197,48,7,91,104,47,125,112,84,18,3,6,150,44,95,165,2,115,37,73,100,108,20,13,83], 82:[49,3,9,64,107,28,42,185,53,161,6,51,44,41,37,104,187,26,66,60,299,48,65,193,55,25,50,13,106,138,87,4,32,114,56,34,188,94,30,99,22,96,16,230,21,18,1,14,304,209,45,2,69,46,38,43,68,79,7,24,74,35,23,158,8,131,29,108,20,77,5,62,145,215,174,17,10,93,72,11,89,59], 83:[15,193,70,9,174,130,12,20,8,85,390,16,33,110,57,14,98,100,86,36,137,65,58,6,67,5,25,154,153,147,133,2,90,17,59,75,24,81,128,178,11,10,203,116,22,34,18,37,7,101,31,53,258,94,26,115,50,182,13,41,63,114,43,3,45,204,69,148,4,19,83,38,149,1,60,27,39,29,51,164,47,35,42], 84:[11,58,59,7,28,57,47,50,80,38,98,10,113,161,20,87,115,29,165,5,41,283,14,34,27,45,112,131,204,60,201,4,141,19,2,119,55,78,64,36,114,79,17,207,56,15,67,89,186,33,122,37,31,13,245,103,8,76,25,1,73,277,43,91,105,32,51,3,9,30,23,185,52,173,206,49,77,172,70,88,129,18,6,16], 85:[11,58,59,7,28,57,47,50,80,38,98,10,113,161,20,87,115,29,165,5,41,283,14,34,27,45,112,131,204,60,201,4,141,19,2,119,55,78,64,36,114,79,17,207,56,15,67,89,186,33,122,37,31,13,245,103,8,76,25,1,73,277,43,91,105,32,51,3,9,30,23,185,52,173,206,49,77,172,70,88,129,18,6,16,127], 86:[13,172,42,87,7,159,5,92,9,54,286,24,212,25,15,180,4,80,78,131,20,183,99,103,38,26,181,12,178,27,16,111,19,100,44,72,32,21,218,147,85,49,89,60,52,122,57,29,108,6,204,157,35,133,2,241,34,56,23,39,59,67,50,11,251,41,66,8,132,175,22,71,17,14,37,145,46,96,311,30,47,18,10,45,3,33], 87:[1,69,13,172,42,87,7,159,5,92,9,54,286,24,212,25,15,180,4,80,78,131,20,183,99,103,38,26,181,12,178,27,16,111,19,100,44,72,32,21,218,147,85,49,89,60,52,122,57,29,108,6,204,157,35,133,2,241,34,56,23,39,59,67,50,11,251,41,66,8,132,175,22,71,17,14,37,145,46,96,311,30,47,18,10,45,3], 88:[1,69,13,172,42,87,7,159,5,92,9,54,286,24,212,25,15,180,4,80,78,131,20,183,99,103,38,26,181,12,178,27,16,111,19,100,44,72,32,21,218,147,85,49,89,60,52,122,57,29,108,6,204,157,35,133,2,241,34,56,23,39,59,67,50,11,251,41,66,8,132,175,22,71,17,14,37,145,46,96,311,30,47,18,10,45,3,33], 89:[1,69,13,172,42,87,7,159,5,92,9,54,286,24,212,25,15,180,4,80,78,131,20,183,99,103,38,26,181,12,178,27,16,111,19,100,44,72,32,21,218,147,85,49,89,60,52,122,57,29,108,6,204,157,35,133,2,241,34,56,23,39,59,67,50,11,251,41,66,8,132,175,22,71,17,14,37,145,46,96,311,30,47,18,10,45,3,33,189], 90:[15,56,4,138,41,26,47,23,74,6,83,51,385,33,7,149,5,14,212,46,11,38,200,22,117,18,88,2,158,127,53,458,12,153,34,16,105,64,55,78,13,32,54,190,65,35,72,129,63,59,145,3,109,62,159,243,125,42,124,69,93,20,230,31,17,44,24,229,76,8,118,25,77,104,87,43,58,94,21,241,141,132,52,79,334,27,9,1,29,81], 91:[36,16,27,26,37,23,22,169,96,147,49,29,6,19,154,121,244,11,62,128,95,99,10,2,46,149,61,167,14,245,34,93,91,28,66,4,162,137,39,159,13,216,1,67,55,359,51,141,7,171,102,8,42,83,5,75,59,41,44,30,87,238,3,140,126,32,132,18,168,340,20,57,15,9,146,116,40,64,56,33,200,131,237,107,17,21,76,112,65,71,47], 92:[17,80,42,53,19,104,64,171,142,7,5,58,78,110,233,105,54,11,182,52,34,35,84,71,94,73,323,18,9,76,41,8,135,2,156,4,29,180,28,222,3,96,10,6,179,25,57,173,55,26,200,215,1,23,44,83,47,231,75,102,280,20,120,292,32,30,36,166,100,46,15,227,21,92,131,128,147,181,91,108,157,39,40,37,13,43,31,14,118,51,38,22], 93:[31,236,47,71,65,112,76,21,17,107,237,131,200,33,56,64,40,116,146,9,15,57,20,340,168,18,132,32,126,140,3,238,87,30,44,41,59,75,5,83,42,8,102,171,7,141,51,359,55,67,1,216,13,159,39,137,162,4,66,28,91,93,34,245,14,167,61,149,46,2,10,99,95,128,62,11,244,121,154,19,6,29,49,147,96,169,22,23,37,26,27,16,36], 94:[22,6,242,10,15,34,104,141,36,16,40,198,62,121,19,220,33,95,1,17,116,26,63,230,76,11,97,102,93,71,60,47,4,64,5,269,109,14,204,81,24,145,46,167,101,43,147,21,8,45,38,23,65,336,188,39,127,90,27,181,35,20,152,42,12,149,9,192,86,151,154,3,119,67,332,13,31,41,58,66,32,289,234,79,57,37,137,103,7,75,2,48,30,70], 95:[3,75,1,7,27,23,174,241,22,208,114,6,10,26,11,116,65,103,32,9,46,201,265,43,203,4,161,30,124,128,97,67,85,19,72,2,64,119,29,88,134,52,147,233,73,99,105,77,45,62,173,38,121,20,112,13,81,108,21,48,146,102,24,261,14,68,137,221,18,31,111,28,90,33,297,15,39,5,56,40,158,244,25,70,80,12,51,216,217,84,109,71,60,89,17,], 96:[61,73,50,49,41,38,28,204,84,116,3,20,207,9,37,16,67,142,104,18,132,5,21,293,34,63,70,75,40,2,54,211,72,4,48,30,101,89,105,69,143,229,6,86,342,98,13,19,68,59,43,45,81,71,291,7,326,24,1,10,151,31,188,33,166,15,80,14,149,47,110,65,201,36,8,278,231,260,17,57,64,27,12,141,144,112,93,125,238,85,29,22,55,58,60,108], 97:[6,61,144,48,9,19,74,17,7,203,142,71,185,197,5,224,4,148,8,23,12,108,176,149,15,1,282,66,208,41,77,10,225,30,58,105,112,29,63,232,38,89,51,139,218,3,133,90,21,103,154,168,44,25,14,26,97,169,107,82,56,125,34,173,100,122,94,64,106,80,50,2,196,62,11,146,20,22,53,450,49,32,54,18,27,155,85,187,121,113,59,37,33,46,55,13,47], 98:[47,13,55,46,33,37,59,113,121,187,85,155,27,18,54,32,49,450,53,22,20,146,11,62,196,2,50,80,106,64,94,122,100,173,34,125,56,82,107,169,97,26,14,25,44,168,154,103,21,90,133,3,218,139,51,89,38,232,63,29,112,105,58,30,225,10,77,41,208,66,282,1,15,149,176,108,12,23,8,148,4,224,5,197,185,71,142,203,7,17,74,19,9,48,144,61,6,78], 99:[78,6,61,144,48,9,19,74,17,7,203,142,71,185,197,5,224,4,148,8,23,12,108,176,149,15,1,282,66,208,41,77,10,225,30,58,105,112,29,63,232,38,89,51,139,218,3,133,90,21,103,154,168,44,25,14,26,97,169,107,82,56,125,34,173,100,122,94,64,106,80,50,2,196,62,11,146,20,22,53,450,49,32,54,18,27,155,85,187,121,113,59,37,33,46,55,13,47,291], 100:[20,23,1,55,7,125,13,58,131,129,30,291,183,37,110,38,51,9,81,105,66,34,12,15,96,57,345,69,28,31,212,65,169,130,68,173,176,21,29,53,137,113,6,16,32,40,193,170,45,136,74,11,8,249,5,315,95,14,35,91,297,4,73,3,84,78,149,67,107,39,139,52,18,124,10,172,184,83,33,121,175,64,102,104,47,228,41,114,108,25,17,75,26,192,177,115,161,2,120,36]}
    return ogrs[length]


class shuffler(PluginBase):

    description = "Uses an optimal golomb ruler to space artist tracks in a non-uniform way (old)"
    
    def shuffle(self,artists):
        for artist,tracks in artists.items():
            random.shuffle(tracks)
            length = len(tracks) - 1
            new_tracks = []
            if length != 0:
                for spaces in ogr(length):
                    new_tracks.append(tracks.pop())
                    new_tracks.extend([0] * spaces)
            new_tracks.append(tracks.pop())
            artists[artist] = new_tracks

        max_len = 0

        for artist,tracks in artists.items():
            if len(tracks) > max_len:
                max_len = len(tracks)

        for artist,tracks in artists.items():
            if len(tracks) < max_len:
                pad = max_len - len(tracks)
                halfsies = ceil(pad / 2)
                tracks.extend([0] * int(halfsies))
                tracks.reverse()
                tracks.extend([0] * int(halfsies))
                tracks.reverse()

        columns = []
        for i in range(0,max_len):
            column = []
            for artist,tracks in artists.items():
                if tracks[i] != 0:
                    entry = artist + "," + tracks[i]
                    column.append(entry)
            if len(column) == 0:
                continue
            random.shuffle(column)
            if i > 0 and len(columns) > 0:
                last_column = columns[-1]
                if len(last_column) > 0 and len(column) > 0:
                    if last_column[-1].split(",")[0] == column[0].split(",")[0]:
                        first = column[0]
                        last = column[-1]
                        column[0] = last
                        column[-1] = first
            columns.append(column)

        tracklist_ordered = []
        for column in columns:
            for track in column:
                explode = track.split(",")
                tracklist_ordered.append(explode[1])

        return tracklist_ordered
